name: CI
on:
  push:
    branches: '**'
  pull_request:
    branches: 'master'

jobs:
  windows:
    runs-on: windows-2016
    strategy:
      matrix:
        config: [ MINGW_64-gcov ]
    name: Build and test
    steps:
      - uses: actions/checkout@v2

      - uses: actions/cache@v2
        with:
          path: C:\projects\nvim-deps
          key: ${{ matrix.config }}-${{ hashFiles('third-party\**') }}

      - name: Run CI
        run: powershell ci\build.ps1
        env:
          CONFIGURATION: ${{ matrix.config }}
